<template lang="pug">
.curso-main-container.pb-3
  BannerInterno
  .container.tarjeta.tarjeta--blanca.p-4.p-md-5.mb-5
    .titulo-principal.color-acento-contenido
      .titulo-principal__numero
        span 3
      h1 Algoritmos de aprendizaje supervisado en acci√≥n con Python
    
    p(data-aos="fade-right") Incluyen algoritmos que toman una muestra de datos y sus respectivas salidas, el objetivo principal es que el algoritmo aprenda c√≥mo se relacionan los datos de entrada X y sus correspondientes salidas Y, a partir de un conjunto de entrenamiento escogido para tal fin.

    p.mb-5.fw-bold(data-aos="fade-right") Con el conocimiento adquirido se puede predecir nuevas salidas a trav√©s de nuevos datos X

    .bloque-texto-g.bloque-texto-g-edit.color-primario.p-3.p-sm-4.p-md-5.col-xl-10.mx-auto(data-aos="fade-right")
      .bloque-texto-g__img(
        :style="{'background-image': `url(${require('@/assets/curso/temas/tema3/img-1.png')})`}"
      )
      .bloque-texto-g__texto.p-4
        p.mb-0 Estos algoritmos se llaman supervisados porque el modelo aprendi√≥ de respuestas y etiquetas conocidas de antemano en la fase de entrenamiento. Los m√©todos de aprendizaje supervisado son de dos tipos principales, esto depende del problema que se desea resolver y pueden ser: algoritmos de regresi√≥n y algoritmos de clasificaci√≥n.
    Separador
    #t_3_1.titulo-segundo.color-acento-contenido
      h2 3.1  Algoritmo de regresi√≥n con Python
    
    p(data-aos="fade-right") La regresi√≥n lineal se utiliza para estimar valores reales como ventas, costos, cantidad de llamadas en una central, gastos, etc., en funci√≥n de unas variables predictoras de tipo continuo. <b>La mejor ecuaci√≥n que se ajusta se llama l√≠nea de regresi√≥n y la ecuaci√≥n utilizada es:</b>

    .d-flex.flex-wrap.mb-5
      .col-md-6.d-flex.flex-wrap.order-2.order-md-1
        .d-flex.pe-md-3.mb-3
          .tarjeta.p-3.p-md-4.mb-auto(style="background-color: #24135A;" data-aos="fade-left")
            p.mb-0(style="color: #FFD945") ùëå = ùëöùëã+ùëè
        .d-flex.pe-md-4.mb-4.col-12.col-lg
          .tarjeta.p-3.p-md-4.w-100(style="background-color: #E2F8F0;" data-aos="fade-left")
            p.fw-bold Donde:
            p.mb-0 ùëå: es la variable dependiente.
              br            
              |ùëö: es la pendiente de la l√≠nea de regresi√≥n.
              br              
              |ùëè: es la intersecci√≥n con el eje Y.
        p.pe-md-4(data-aos="fade-right") La regresi√≥n lineal puede ser simple o m√∫ltiple, la primera se caracteriza por tener una variable independiente, contrario a la regresi√≥n m√∫ltiple que se caracteriza por tener m√°s de una variable independiente.
        p.mb-0.pe-lg-4(data-aos="fade-right") Volviendo al ejemplo propuesto se utilizar√° la librer√≠a <em><b style="background-color: #E1E2FC">scikit-learn,</b></em> que es una librer√≠a para el aprendizaje autom√°tico. En el siguiente recurso se pueden identificar los m√≥dulos a implementar y los pasos a seguir:
      img.mx-auto.mx-md-0.col-md-6.col-xl-5.mb-4.mb-md-auto.order-1.order-md-2(src="@/assets/curso/temas/tema3/img-2.png" style="max-width: 492px")
    
    .tarjeta.p-5(style="background-color: #EBECFF")
      LineaTiempoC.color-acento-contenido(text-small)
        .col-lg-11.mx-auto.d-flex.flex-wrap(titulo="Paso 1")
          .col-lg-8.pe-lg-4.order-2.order-lg-1
            p Lo primero que se debe tener en cuenta es que: 
            p linear_model: sirve para entrenar un modelo de Machine Learning de regresi√≥n lineal. 
              br            
              |#[b train_test_split:] sirve para dividir los datos en datos de entrenamiento y datos de prueba. 
              br              
              |#[b metrics:] sirve para medir el desempe√±o del modelo.
            p.fw-bold En ese orden de ideas el c√≥digo a utilizar es:
            .d-flex.pe-md-3.mb-3
              .tarjeta.px-4.py-2(style="background-color: #24135A;" data-aos="fade-left")
                p.mb-0.text-white import seaborn as sns 
                  br                
                  |import matplotlib.pyplot as plt 
                  br                  
                  |from sklearn.linear_model import LinearRegression 
                  br                  
                  |from sklearn.model_selection import train_test_split 
                  br                  
                  |from sklearn.metrics import mean_squared_error, r2_score
          img.mx-auto.col-lg-4.order-1.order-lg-2(src="@/assets/curso/temas/tema3/img-3.svg" style="max-width: 290px")

        .col-lg-11.mx-auto.d-flex.flex-wrap(titulo="Paso 2")
          .col-lg-8.pe-lg-4.order-2.order-lg-1
            p Para entrenar el modelo con esta librer√≠a inicialmente se carga el valor de X con los datos de la longitud de la aleta #[b (flipper_length_mm)], y Y con los datos de masa del ping√ºino #[b (body_mass_g)], posteriormente se obtiene un subconjunto de datos que ser√°n el dataset de entrenamiento y el set de pruebas en las variables #[b X_train, Y_train, X_test, Y_test] en una proporci√≥n de 80 % para los datos de entrenamiento y 20 % para los datos de prueba.
            p.fw-bold El c√≥digo a utilizar es:
            .d-flex.pe-md-3.mb-3
              .tarjeta.px-4.py-2(style="background-color: #24135A;" data-aos="fade-left")
                p.mb-0.text-white X = df_pinguinos[‚Äúflipper_length_mm‚Äù].values.reshape(-1,1) 
                  br
                  |Y = df_pinguinos[‚Äúbody_mass_g‚Äù] 
                  br
                  |X_train, X_test, Y_train, Y_test = train_test_split(X, Y, test_size = 0.20, random_state = 42)
          img.mx-auto.col-lg-4.order-1.order-lg-2(src="@/assets/curso/temas/tema3/img-4.svg" style="max-width: 290px")

        .col-lg-11.mx-auto.d-flex.flex-wrap(titulo="Paso 3")
          .col-lg-8.pe-lg-4.order-2.order-lg-1
            p Posteriormente, se crea una instancia de LinearRegresion y se instruye a la regresi√≥n lineal que aprenda de los datos #[b X_train y Y_train], para lo cual se usa el m√©todo fit para ajustar los par√°metros de la l√≠nea de regresi√≥n a los datos, es decir, se entrena a la regresi√≥n lineal.
            p.fw-bold Para ese fin se utiliza el siguiente c√≥digo:
            .d-flex.pe-md-3.mb-3
              .tarjeta.px-4.py-2(style="background-color: #24135A;" data-aos="fade-left")
                p.mb-0.text-white regresion = LinearRegression() 
                  br
                  |model = reg.fit(X_train, Y_train)
          img.mx-auto.col-lg-4.order-1.order-lg-2(src="@/assets/curso/temas/tema3/img-3.svg" style="max-width: 290px")

        .col-lg-11.mx-auto.d-flex.flex-wrap(titulo="Paso 4")
          .col-lg-8.pe-lg-4.order-2.order-lg-1
            p Una vez realizado esto ya se pueden observar los par√°metros que estima la regresi√≥n lineal : 
            p print(‚Äòm = ‚Äò + str(regresion.coef_) + ‚Äò, b = ‚Äò 
              br            
              |+ str(regresion.intercept_)) 
              br              
              |m = [50.41798199], b = -5919.258741821233 , 
            p Los par√°metros obtenidos m y b se reemplazan en la ecuaci√≥n de regresi√≥n y se obtiene:
            .d-flex.pe-md-3.mb-3
              .tarjeta.px-4.py-2(style="background-color: #24135A;" data-aos="fade-left")
                p.mb-0.text-white ùë¶ = 50.417981ùë• ‚àí5919.25874
          img.mx-auto.col-lg-4.order-1.order-lg-2(src="@/assets/curso/temas/tema3/img-4.svg" style="max-width: 290px")
        
        .col-lg-11.mx-auto.d-flex.flex-wrap(titulo="Paso 5")
          .col-lg-8.pe-lg-4.order-2.order-lg-1
            p Luego de haber realizado este proceso, ya se puede predecir el resultado de la masa de un ping√ºino con una longitud de una aleta, usando el m√©todo predict de la clase LinearRegression. Si se desea saber cu√°l es la masa aproximada de un ping√ºino que tiene una longitud de la aleta de unos 200 mm, se usa el siguiente c√≥digo:
            .d-flex.pe-md-3.mb-3
              .tarjeta.px-4.py-2(style="background-color: #24135A;" data-aos="fade-left")
                p.text-white longitudAleta =np.array ([200]) 
                  br
                  |prediccion = regresion.predict(longitudAleta.reshape(-1,1)) 
                  br
                  |print (‚ÄòEl valor de la masa de un ping√ºino que tiene longitud de aleta = ‚Äò + str(longitudAleta) + ‚Äò mm es ‚Äò + str(prediccion )) 

                p.text-white.mb-0 El valor de la masa de un ping√ºino que tiene longitud de aleta = [200] mm es [4164.3376571]
          img.mx-auto.col-lg-4.order-1.order-lg-2(src="@/assets/curso/temas/tema3/img-3.svg" style="max-width: 290px")
        
        .col-lg-11.mx-auto.d-flex.flex-wrap(titulo="Paso 6")
          .col-lg-8.pe-lg-4.order-2.order-lg-1
            p La ra√≠z cuadrada del coeficiente de determinaci√≥n es R y puede variar entre -1 y 1, conocido como coeficiente de correlaci√≥n de Pearson. Este coeficiente mide el grado de asociaci√≥n lineal entre dos variables X y Y, el signo indica la direcci√≥n de la correlaci√≥n y el valor num√©rico, el grado de correlaci√≥n.
          img.mx-auto.col-lg-4.order-1.order-lg-2(src="@/assets/curso/temas/tema3/img-4.svg" style="max-width: 290px")
</template>

<script>
export default {
  name: 'Tema3',
  data: () => ({
    // variables de vue
  }),
  mounted() {
    this.$nextTick(() => {
      this.$aosRefresh()
    })
  },
  updated() {
    this.$aosRefresh()
  },
}
</script>

<style lang="sass">
.bloque-texto-g-edit
  .bloque-texto-g__img
    width: 404px
  .bloque-texto-g__texto
    width: 75%
  @media (max-width: 991px)
    .bloque-texto-g__img
      width: 100%
    .bloque-texto-g__texto
      width: 100%
</style>
